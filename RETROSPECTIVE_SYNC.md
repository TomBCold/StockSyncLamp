# –†–µ—Ç—Ä–æ—Å–ø–µ–∫—Ç–∏–≤–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

## –û–ø–∏—Å–∞–Ω–∏–µ

–†–µ—Ç—Ä–æ—Å–ø–µ–∫—Ç–∏–≤–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –æ–± –æ—Å—Ç–∞—Ç–∫–∞—Ö —Ç–æ–≤–∞—Ä–æ–≤ –∑–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥. –≠—Ç–æ –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏.

## –û—Ç–ª–∏—á–∏—è –æ—Ç –æ–±—ã—á–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–±—ã—á–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è | –†–µ—Ç—Ä–æ—Å–ø–µ–∫—Ç–∏–≤–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è |
|----------|----------------------|------------------------------|
| **–ó–∞–ø—É—Å–∫** | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ cron | –¢–æ–ª—å–∫–æ –≤—Ä—É—á–Ω—É—é |
| **–ü–µ—Ä–∏–æ–¥** | –¢–µ–∫—É—â–∏–π –º–æ–º–µ–Ω—Ç | –ó–∞–¥–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥ (–æ—Ç-–¥–æ) |
| **–ü–æ–ª–µ date** | –î–∞—Ç–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ | –î–∞—Ç–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ |
| **–ü–æ–ª–µ stock_date** | NULL | **–î–∞—Ç–∞ –æ—Å—Ç–∞—Ç–∫–∞** –∏–∑ API |
| **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ** | –¢–µ–∫—É—â–∏–µ –æ—Å—Ç–∞—Ç–∫–∏ | –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ |

---

## –ù–æ–≤–æ–µ –ø–æ–ª–µ –≤ —Ç–∞–±–ª–∏—Ü–µ: stock_date

**–î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `stock_date`** - –¥–∞—Ç–∞, –∑–∞ –∫–æ—Ç–æ—Ä—É—é –ø–æ–ª—É—á–µ–Ω –æ—Å—Ç–∞—Ç–æ–∫ –∏–∑ API –ú–æ–π–°–∫–ª–∞–¥.

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| `date` | DATETIMEOFFSET | –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ (–∫–æ–≥–¥–∞ –¥–∞–Ω–Ω—ã–µ –±—ã–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã) |
| `stock_date` | DATE | –î–∞—Ç–∞ –æ—Å—Ç–∞—Ç–∫–∞ (–∑–∞ –∫–∞–∫—É—é –¥–∞—Ç—É —ç—Ç–æ—Ç –æ—Å—Ç–∞—Ç–æ–∫) |

**–ü—Ä–∏–º–µ—Ä:**
```sql
INSERT INTO dbo.pbi_test VALUES (
  ...,
  '2025-12-02T10:30:00+03:00',  -- date: –∫–æ–≥–¥–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–æ
  '2025-01-15',                  -- stock_date: –æ—Å—Ç–∞—Ç–æ–∫ –∑–∞ 15 —è–Ω–≤–∞—Ä—è
  ...
);
```

---

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ .env (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–í —Ñ–∞–π–ª–µ `.env`:
```env
# –ü–µ—Ä–∏–æ–¥ –¥–ª—è —Ä–µ—Ç—Ä–æ—Å–ø–µ–∫—Ç–∏–≤–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
RETRO_START_DATE=2025-01-01
RETRO_END_DATE=2025-12-31
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞

–ú–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –¥–∞—Ç—ã –≤ —Ç–µ–ª–µ POST –∑–∞–ø—Ä–æ—Å–∞ (–ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç .env).

---

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ —Ä–µ—Ç—Ä–æ—Å–ø–µ–∫—Ç–∏–≤–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

#### –ß–µ—Ä–µ–∑ .env (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω—ã RETRO_START_DATE –∏ RETRO_END_DATE):

```bash
curl -X POST http://localhost:3000/sync/retrospective
```

#### –ß–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–∞:

```bash
curl -X POST http://localhost:3000/sync/retrospective \
  -H "Content-Type: application/json" \
  -d '{
    "startDate": "2025-01-01",
    "endDate": "2025-01-31"
  }'
```

#### PowerShell:

```powershell
Invoke-RestMethod -Uri "http://localhost:3000/sync/retrospective" `
  -Method POST `
  -ContentType "application/json" `
  -Body '{"startDate":"2025-01-01","endDate":"2025-01-31"}'
```

---

## –û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞

### –£—Å–ø–µ—à–Ω—ã–π –∑–∞–ø—É—Å–∫:

```json
{
  "message": "–†–µ—Ç—Ä–æ—Å–ø–µ–∫—Ç–∏–≤–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∑–∞–ø—É—â–µ–Ω–∞",
  "period": {
    "startDate": "2025-01-01",
    "endDate": "2025-01-31"
  },
  "timestamp": "2025-12-02T10:30:00.000Z"
}
```

### –û—à–∏–±–∫–∞ (–Ω–µ—Ç –¥–∞—Ç):

```json
{
  "error": "–ù–µ —É–∫–∞–∑–∞–Ω—ã –¥–∞—Ç—ã",
  "message": "–£–∫–∞–∂–∏—Ç–µ startDate –∏ endDate –≤ —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–∞ –∏–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ RETRO_START_DATE –∏ RETRO_END_DATE –≤ .env",
  "example": {
    "startDate": "2025-01-01",
    "endDate": "2025-01-31"
  }
}
```

---

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### 1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–∞—Å—Å–∏–≤–∞ –¥–∞—Ç

–°–µ—Ä–≤–∏—Å —Å–æ–∑–¥–∞–µ—Ç –º–∞—Å—Å–∏–≤ –¥–∞—Ç –º–µ–∂–¥—É –Ω–∞—á–∞–ª—å–Ω–æ–π –∏ –∫–æ–Ω–µ—á–Ω–æ–π –¥–∞—Ç–æ–π:
```
2025-01-01
2025-01-02
2025-01-03
...
2025-01-31
```

### 2. –î–ª—è –∫–∞–∂–¥–æ–π –¥–∞—Ç—ã –∏ –∫–∞–∂–¥–æ–≥–æ —Å–∫–ª–∞–¥–∞

–ó–∞–ø—Ä–∞—à–∏–≤–∞—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º `moment`:
```
GET /api/remap/1.2/report/stock/all
  ?filter=moment=2025-01-15 23:59:59;archived=false;archived=true;store=...
```

### 3. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Å —É–∫–∞–∑–∞–Ω–∏–µ–º:
- `date` = —Ç–µ–∫—É—â–∞—è –¥–∞—Ç–∞/–≤—Ä–µ–º—è (–∫–æ–≥–¥–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–æ)
- `stock_date` = –¥–∞—Ç–∞ –æ—Å—Ç–∞—Ç–∫–∞ (2025-01-15)

---

## –õ–æ–≥–∏

### –í –∫–æ–Ω—Å–æ–ª–∏/—Ñ–∞–π–ª–µ –ª–æ–≥–æ–≤:

```
=== –ù–∞—á–∞–ª–æ —Ä–µ—Ç—Ä–æ—Å–ø–µ–∫—Ç–∏–≤–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å 2025-01-01 –ø–æ 2025-01-31 ===
–ë—É–¥–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ 31 –¥–∞—Ç –¥–ª—è 3 —Å–∫–ª–∞–¥–æ–≤

--- –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞—Ç—ã: 2025-01-01 ---
–ó–∞–ø—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–∫–ª–∞–¥–∞ 6599a08d-... –∑–∞ 2025-01-01
–ü–æ–ª—É—á–µ–Ω–æ 150 –∑–∞–ø–∏—Å–µ–π –∏–∑ API –¥–ª—è —Å–∫–ª–∞–¥–∞ 6599a08d-... –∑–∞ 2025-01-01
–ó–∞–ø–∏—Å–∞–Ω–æ 150 –∑–∞–ø–∏—Å–µ–π –¥–ª—è —Å–∫–ª–∞–¥–∞ 6599a08d-... –∑–∞ 2025-01-01

--- –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞—Ç—ã: 2025-01-02 ---
...

=== –†–µ—Ç—Ä–æ—Å–ø–µ–∫—Ç–∏–≤–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞ ===
–î–∞—Ç: 31, –°–∫–ª–∞–¥–æ–≤: 3
–£—Å–ø–µ—à–Ω–æ: 93, –û—à–∏–±–æ–∫: 0
–í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π: 13950
```

---

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### 1. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ 2024 –≥–æ–¥

```env
RETRO_START_DATE=2024-01-01
RETRO_END_DATE=2024-12-31
```

```bash
curl -X POST http://localhost:3000/sync/retrospective
```

–ó–∞–≥—Ä—É–∑–∏—Ç—Å—è 365 –¥–∞—Ç √ó –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∫–ª–∞–¥–æ–≤.

### 2. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –º–µ—Å—è—Ü

```bash
curl -X POST http://localhost:3000/sync/retrospective \
  -H "Content-Type: application/json" \
  -d '{
    "startDate": "2025-11-01",
    "endDate": "2025-11-30"
  }'
```

### 3. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –Ω–µ–¥–µ–ª—é

```bash
curl -X POST http://localhost:3000/sync/retrospective \
  -H "Content-Type: application/json" \
  -d '{
    "startDate": "2025-12-01",
    "endDate": "2025-12-07"
  }'
```

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –ø–æ –¥–∞—Ç–∞–º –æ—Å—Ç–∞—Ç–∫–æ–≤:

```sql
SELECT 
    stock_date,
    COUNT(*) as record_count,
    COUNT(DISTINCT id_warehouse) as warehouses,
    COUNT(DISTINCT id_prod) as products
FROM dbo.pbi_test
WHERE stock_date IS NOT NULL
GROUP BY stock_date
ORDER BY stock_date DESC;
```

### –î–∞–Ω–Ω—ã–µ –∑–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –¥–∞—Ç—É:

```sql
SELECT TOP 10 *
FROM dbo.pbi_test
WHERE stock_date = '2025-01-15'
ORDER BY id;
```

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–∞—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∏ –æ—Å—Ç–∞—Ç–∫–æ–≤:

```sql
SELECT 
    CAST([date] AS DATE) as sync_date,
    stock_date,
    COUNT(*) as records
FROM dbo.pbi_test
WHERE stock_date IS NOT NULL
GROUP BY CAST([date] AS DATE), stock_date
ORDER BY sync_date DESC, stock_date DESC;
```

---

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ (–ø—Ä–∏–º–µ—Ä–Ω–æ):

| –ü–µ—Ä–∏–æ–¥ | –î–Ω–µ–π | –°–∫–ª–∞–¥–æ–≤ | –ó–∞–ø–∏—Å–µ–π | –í—Ä–µ–º—è (–ø—Ä–∏–º–µ—Ä–Ω–æ) |
|--------|------|---------|---------|------------------|
| 1 –Ω–µ–¥–µ–ª—è | 7 | 3 | ~3000 | 2-5 –º–∏–Ω—É—Ç |
| 1 –º–µ—Å—è—Ü | 30 | 3 | ~15000 | 10-20 –º–∏–Ω—É—Ç |
| 3 –º–µ—Å—è—Ü–∞ | 90 | 3 | ~45000 | 30-60 –º–∏–Ω—É—Ç |
| 1 –≥–æ–¥ | 365 | 3 | ~180000 | 2-4 —á–∞—Å–∞ |

**–§–∞–∫—Ç–æ—Ä—ã:**
- –°–∫–æ—Ä–æ—Å—Ç—å API –ú–æ–π–°–∫–ª–∞–¥
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ —Å–∫–ª–∞–¥–µ
- –°–∫–æ—Ä–æ—Å—Ç—å —Å–µ—Ç–∏
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ë–î

---

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### ‚úÖ –•–æ—Ä–æ—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏:

1. **–ó–∞–≥—Ä—É–∂–∞–π—Ç–µ –±–æ–ª—å—à–∏–µ –ø–µ—Ä–∏–æ–¥—ã —á–∞—Å—Ç—è–º–∏:**
   ```bash
   # –í–º–µ—Å—Ç–æ —Ü–µ–ª–æ–≥–æ –≥–æ–¥–∞ –∑–∞ —Ä–∞–∑:
   curl ... -d '{"startDate":"2024-01-01","endDate":"2024-03-31"}'  # Q1
   curl ... -d '{"startDate":"2024-04-01","endDate":"2024-06-30"}'  # Q2
   curl ... -d '{"startDate":"2024-07-01","endDate":"2024-09-30"}'  # Q3
   curl ... -d '{"startDate":"2024-10-01","endDate":"2024-12-31"}'  # Q4
   ```

2. **–ó–∞–≥—Ä—É–∂–∞–π—Ç–µ –≤ –Ω–µ—Ä–∞–±–æ—á–µ–µ –≤—Ä–µ–º—è** (–Ω–æ—á—å—é, –≤—ã—Ö–æ–¥–Ω—ã–µ)

3. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ª–æ–≥–∏** –≤–æ –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏

4. **–î–µ–ª–∞–π—Ç–µ backup –ë–î** –ø–µ—Ä–µ–¥ –±–æ–ª—å—à–æ–π –∑–∞–≥—Ä—É–∑–∫–æ–π

### ‚ö†Ô∏è –ò–∑–±–µ–≥–∞–π—Ç–µ:

1. ‚ùå –ó–∞–≥—Ä—É–∑–∫–∏ –æ–¥–Ω–∏—Ö –∏ —Ç–µ—Ö –∂–µ –¥–∞—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ (–¥—É–±–ª–∏)
2. ‚ùå –ó–∞–ø—É—Å–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ä–µ—Ç—Ä–æ—Å–ø–µ–∫—Ç–∏–≤–Ω—ã—Ö —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
3. ‚ùå –ó–∞–≥—Ä—É–∑–∫–∏ –æ—á–µ–Ω—å –±–æ–ª—å—à–∏—Ö –ø–µ—Ä–∏–æ–¥–æ–≤ –∑–∞ —Ä–∞–∑ (>1 –≥–æ–¥–∞)

---

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞ "–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç—ã"

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–æ—Ä–º–∞—Ç `YYYY-MM-DD`:
```json
{
  "startDate": "2025-01-01",  ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
  "endDate": "2025-01-31"
}
```

```json
{
  "startDate": "01.01.2025",  ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
  "endDate": "31/01/2025"     ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
}
```

### –û—à–∏–±–∫–∞ "–ù–∞—á–∞–ª—å–Ω–∞—è –¥–∞—Ç–∞ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –±–æ–ª—å—à–µ –∫–æ–Ω–µ—á–Ω–æ–π"

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Ä—è–¥–æ–∫ –¥–∞—Ç:
```json
{
  "startDate": "2025-01-31",  ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
  "endDate": "2025-01-01"
}
```

### –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∑–∞–≤–∏—Å–ª–∞

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `logs/sync.log`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ API
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å

---

## SQL –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—è stock_date

–ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ —É–∂–µ —Å–æ–∑–¥–∞–Ω–∞ –±–µ–∑ –ø–æ–ª—è `stock_date`:

```sql
-- –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ
ALTER TABLE dbo.pbi_test
ADD stock_date DATE NULL;

-- –°–æ–∑–¥–∞—Ç—å –∏–Ω–¥–µ–∫—Å
CREATE INDEX idx_stock_date ON dbo.pbi_test(stock_date);
CREATE INDEX idx_warehouse_stock_date ON dbo.pbi_test(id_warehouse, stock_date);
```

---

## –ò—Ç–æ–≥

–†–µ—Ç—Ä–æ—Å–ø–µ–∫—Ç–∏–≤–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø–æ–∑–≤–æ–ª—è–µ—Ç:
- ‚úÖ –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –∑–∞ –ª—é–±–æ–π –ø–µ—Ä–∏–æ–¥
- ‚úÖ –†–∞–∑–¥–µ–ª–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ –¥–∞—Ç–∞–º –æ—Å—Ç–∞—Ç–∫–æ–≤ (`stock_date`)
- ‚úÖ –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∏–Ω–∞–º–∏–∫—É –æ—Å—Ç–∞—Ç–∫–æ–≤
- ‚úÖ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∑–∞ –ø—Ä–æ—à–ª—ã–µ –ø–µ—Ä–∏–æ–¥—ã

**–î–ª—è –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏:**
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –¥–∞—Ç—ã –≤ `.env`
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ: `curl -X POST http://localhost:3000/sync/retrospective`
3. –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ª–æ–≥–∏
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ –≤ –ë–î

–ì–æ—Ç–æ–≤–æ! üéâ

