# TODO - Доработки после получения информации от API

## Необходимо получить от пользователя:

### 1. Структура таблицы БД
После получения структуры таблицы обновить файл `models/Stock.js`:
- [ ] Добавить все поля таблицы с правильными типами данных
- [ ] Настроить индексы для оптимизации запросов
- [ ] Настроить имя таблицы, если отличается от 'stocks'

### 2. Пример ответа API
После получения примера ответа API обновить:
- [ ] `services/apiService.js` - настроить правильную обработку пагинации
- [ ] `services/apiService.js` - добавить правильные параметры запроса
- [ ] `services/syncService.js` - настроить маппинг полей из API в модель БД

### 3. Формат списка складов
Уточнить формат:
- [ ] Коды складов или названия?
- [ ] Один склад - одна строка в файле?
- [ ] Нужны ли дополнительные параметры для складов?

---

## Текущие заглушки в коде:

### models/Stock.js
```javascript
// TODO: Добавить поля модели согласно структуре таблицы
```

### services/apiService.js
```javascript
// TODO: Добавить другие параметры после получения примера ответа API
// TODO: Уточнить логику проверки после получения примера ответа
```

### services/syncService.js
```javascript
// TODO: Маппинг полей после получения структуры таблицы и примера ответа API
// TODO: Раскомментировать после добавления модели
// await db.Stock.bulkCreate(recordsToInsert);
```

---

## Возможные улучшения (опционально):

### Функциональность
- [ ] Добавить веб-интерфейс для мониторинга синхронизации
- [ ] Добавить уведомления при ошибках (email, Telegram и т.д.)
- [ ] Добавить API endpoint для просмотра истории синхронизаций
- [ ] Добавить возможность синхронизации конкретного склада
- [ ] Добавить retry механизм при сбоях API
- [ ] Добавить очистку старых данных (архивирование)

### Производительность
- [ ] Добавить параллельную обработку складов
- [ ] Добавить кэширование данных API
- [ ] Оптимизировать запросы к БД (batch insert)

### Безопасность
- [ ] Добавить аутентификацию для API endpoints
- [ ] Добавить rate limiting
- [ ] Добавить валидацию входных данных

### Логирование
- [ ] Добавить ротацию логов
- [ ] Добавить разные уровни логирования (debug, info, warning, error)
- [ ] Добавить логирование в базу данных

---

## Тестирование

После настройки выполнить:
1. `npm run test:db` - проверка подключения к БД
2. `npm run test:api` - проверка подключения к API
3. `npm start` - запуск сервера
4. POST запрос на `http://localhost:3000/sync/manual` - тестовая синхронизация

---

## Примечания

- Файл `env.example.txt` содержит пример конфигурации - скопировать в `.env` и заполнить реальными данными
- Файл `warehouses.txt` должен содержать список складов (по одному на строку)
- Логи сохраняются в `logs/sync.log`
- Для Windows Service использовать скрипты `install-service-windows.js` и `uninstall-service-windows.js`

